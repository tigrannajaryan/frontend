<ion-header madeHeader [hideBackButton]="true"></ion-header>


<ion-content class="StylistsPage">
  <div class="contentSidePadding">
    <div class="StylistsPage-searchWrap">
      <ion-item class="FormControl StylistsPage-search">
        <ion-input type="text" placeholder="Search stylists for…" [formControl]="query" (input)="onSearchStylists()" data-test-id="searchInput"></ion-input>
      </ion-item>
      <i class="StylistsPage-searchIcon mb-icon-search"></i>
    </div>
    <ion-row class="H2" align-items-center justify-content-between>
      <div>
        <span>All stylists</span>
        <span *ngIf="(stylists | async)?.length > 0" class="Badge">{{ (stylists | async)?.length }}</span>
      </div>
      <div *ngIf="(requestState | async) === RequestState.Loading && (stylists | async) !== undefined" class="StylistsPage-loader">searching…</div>
    </ion-row>

    <!-- Showing loading cards -->
    <div *ngIf="(requestState | async) === RequestState.Loading && (stylists | async) === undefined" class="StylistsPage-stylists">
      <div *ngFor="let stylist of loadingStylists" class="Card is-loading">
        <div class="StylistsPage-cardSubtitle">&nbsp;</div>
        <div class="StylistsPage-cardTitle">&nbsp;</div>
        <div class="StylistsPage-cardSubtitle">&nbsp;</div>
      </div>
    </div>

    <!-- Showing stylists -->
    <div *ngIf="stylists | async" class="StylistsPage-stylists">
      <div
        *ngFor="let stylist of stylists | async"
        class="StylistsPage-card Card"
        [ngClass]="{'is-active': stylist.uuid === activeStylist?.uuid}"
        (click)="onSetActiveStylist($event, stylist)">
        <div class="StylistsPage-cardImg" [style.backgroundImage]="'url(' + (stylist.profile_photo_url  || 'assets/icons/stylist-avatar.svg') + ')'"></div>
        <div class="StylistsPage-cardHeader">
          Your stylist
          <i (click)="onSetActiveStylist($event, undefined)" class="StylistsPage-cardClose mb-icon-cross"></i>
        </div>
        <div class="StylistsPage-cardSubtitle">{{ stylist.salon_name }}</div>
        <div class="StylistsPage-cardTitle">{{ stylist.first_name }} {{ stylist.last_name }}</div>
        <div class="StylistsPage-cardSubtitle"><img src="assets/icons/location.svg" />&nbsp;{{ stylist.salon_address }}</div>
        <div class="StylistsPage-cardFooter">
          <div *ngIf="stylist.phone" class="StylistsPage-cardSubtitle"><img src="assets/icons/phone.svg" />&nbsp;{{ stylist.phone | formatPhone }}</div>
          <div *ngIf="stylist.instagram_profile_name" class="StylistsPage-cardSubtitle"><img src="assets/icons/instagram.svg" />&nbsp;{{ stylist.instagram_profile_name }}</div>
          <button (click)="onContinueWithStylist(stylist)" ion-button class="Button StylistsPage-submit">Continue with {{ stylist.first_name }}</button>
        </div>
      </div>
      <div *ngIf="(stylists | async)?.length === 0">No stylists found</div>
    </div>
  </div>
</ion-content>
